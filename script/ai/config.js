globalThis.ModelContinueRequestLoopLimit=10,globalThis.ModelList=[],globalThis.Model2AI={"gemini-1.5-flash-exp-0827":"Gemini","gemini-1.5-pro-exp-0827":"Gemini","gemini-1.5-flash-002":"Gemini","gemini-1.5-pro-002":"Gemini","claude-3-5-sonnet-20240620":"Claude","claude-3-opus-20240229":"Claude","claude-3-haiku-20240307":"Claude","chatgpt-4o-latest":"OpenAI","gpt-4o-mini":"OpenAI","o1-preview":"OpenAI","o1-mini":"OpenAI","moonshot-v1-auto":"MoonShot","deepseek-chat":"DeepSeek","deepseek-coder":"DeepSeek","abab6.5s-chat":"MiniMax","glm-4-plus":"GLM","glm-4-long":"GLM","glm-4-flash":"GLM","ernie-4.0-8k":"Ernie","open-mixtral-8x22b":"Mixtral","open-mistral-7b":"Mixtral","open-mistral-nemo":"Mixtral","open-codestral-mamba":"Mixtral","pixtral-12b-latest":"Mixtral","gemma2-9b-it":"Groq","llama-3.1-70b-versatile":"Groq","llama-3.2-11b-vision-preview":"Groq","llama-3.2-90b-text-preview":"Groq"},globalThis.AI2Model={gemini:["gemini-1.5-flash-exp-0827","gemini-1.5-pro-exp-0827","gemini-1.5-flash-002","gemini-1.5-pro-002"],claude:["claude-3-5-sonnet-20240620","claude-3-opus-20240229","claude-3-haiku-20240307"],openai:["chatgpt-4o-latest","gpt-4o-mini","o1-preview","o1-mini"],moonshot:["moonshot-v1-auto"],deepseek:["deepseek-chat","deepseek-coder"],minimax:["abab6.5s-chat"],glm:["glm-4-plus","glm-4-long","glm-4-flash"],ernie:["ernie-4.0-8k"],mixtral:["open-mixtral-8x22b","open-mistral-7b","open-mistral-nemo","open-codestral-mamba","pixtral-12b-latest"],groq:["gemma2-9b-it","llama-3.1-70b-versatile","llama-3.2-11b-vision-preview","llama-3.2-90b-text-preview"]},globalThis.FastAI={Gemini:"gemini-1.5-flash-002",Claude:"claude-3-5-sonnet-20240620",OpenAI:"gpt-4o-mini",GLM:"glm-4-flash",Ernie:"ernie-4.0-8k"},globalThis.DeepAI={Gemini:"gemini-1.5-pro-002",Claude:"claude-3-opus-20240229",Openai:"o1-preview",GLM:"glm-4-plus",Ernie:"ernie-4.0-8k"},globalThis.ModelOrder=["gemini","claude","openai","deepseek","moonshot","glm","ernie","minimax","groq","mixtral"],globalThis.ModelNameList={"gemini-1.5-flash-exp-0827":"GeminiFlash","gemini-1.5-pro-exp-0827":"GeminiPro","claude-3-5-sonnet-20240620":"Sonnet3.5","claude-3-opus-20240229":"Opus3","chatgpt-4o-latest":"GPT","gpt-4o-mini":"GPTMini","o1-preview":"O1","o1-mini":"O1-Mini","moonshot-v1-auto":"KIMI","deepseek-chat":"DeepSeek","abab6.5s-chat":"MiniMax","glm-4-plus":"GLMPlus","glm-4-long":"GLMLong","glm-4-flash":"GLMFlash","ernie-4.0-8k":"Ernie","open-mixtral-8x22b":"OpenMixtral","open-mistral-nemo":"MistralNemo","pixtral-12b-latest":"Pixtral","gemma2-9b-it":"Gemma2","llama-3.1-70b-versatile":"LLaMa3.1","llama-3.2-90b-text-preview":"LLaMa3.2"},globalThis.ModelDefaultConfig={Gemini:{header:{"content-type":"application/json"},chat:{generationConfig:{temperature:1,topP:.95,topK:32,candidateCount:1,maxOutputTokens:8192,responseMimeType:"text/plain",stopSequences:[]},safetySettings:[{category:"HARM_CATEGORY_HARASSMENT",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_HATE_SPEECH",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_SEXUALLY_EXPLICIT",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_DANGEROUS_CONTENT",threshold:"BLOCK_NONE"}]}},Claude:{header:{Accept:"application/json","content-type":"application/json","anthropic-version":"2023-06-01","anthropic-beta":"messages-2023-12-15","anthropic-dangerous-direct-browser-access":!0},chat:{top_k:3,temperature:1,max_tokens:4096}},OpenAI:{header:{"Content-Type":"application/json"},chat:{temperature:1,max_tokens:4096}},GLM:{header:{"Content-Type":"application/json"},chat:{temperature:.95,max_tokens:4095}},MoonShot:{header:{"Content-Type":"application/json"},chat:{temperature:1,max_tokens:8192}},DeepSeek:{header:{Accept:"application/json","Content-Type":"application/json"},chat:{temperature:1,max_tokens:8192}},MiniMax:{header:{"Content-Type":"application/json"},chat:{temperature:.9,max_tokens:245760}},Ernie:{header:{"Content-Type":"application/json;charset=utf-8",Accept:"application/json"},chat:{temperature:.95,max_output_tokens:2048}},Mixtral:{header:{"Content-Type":"application/json",Accept:"application/json"},chat:{temperature:.95,max_tokens:32e3}},Groq:{header:{"Content-Type":"application/json"},chat:{temperature:.95,max_tokens:8192}},"claude-3-5-sonnet-20240620":{header:{"anthropic-beta":"max-tokens-3-5-sonnet-2024-07-15"},chat:{max_tokens:8192}},"chatgpt-4o-latest":{chat:{max_tokens:16384}},"gpt-4o-mini":{chat:{max_tokens:16384}},"o1-preview":{chat:{max_tokens:32768}},"o1-mini":{chat:{max_tokens:65536}},"open-mixtral-8x22b":{chat:{max_tokens:64e3}},"open-codestral-mamba":{chat:{max_tokens:256e3}},"open-mistral-nemo":{chat:{max_tokens:128e3}}},globalThis.getFunctionalModelList=e=>{var i=[];return(FunctionalModel[e]||[]).forEach(e=>{var t=Model2AI[e];if(t){if("ernie"===(t=t.toLowerCase())){var a=myInfo.apiKey[t];if(!a||!a.api||!a.secret)return}else if(!myInfo.apiKey[t])return;i.push(e)}}),i.includes(myInfo.model)||i.push(myInfo.model),i},globalThis.FunctionalModel={excludeIrrelevants:["gemini-1.5-flash-exp-0827","o1-mini","deepseek-chat","moonshot-v1-auto"],identityRelevants:["chatgpt-4o-latest","deepseek-chat","glm-4-plus","claude-3-5-sonnet-20240620"]},globalThis.ModelRateLimit={OpenAI:{rpm:5e3,tpm:8e5},Claude:{rpm:2e3,tpm:16e4},Gemini:{rpm:15,tpm:32e3},GLM:{rpm:20,tpm:0},MoonShot:{rpm:3,tpm:32e3},MiniMax:{rpm:6,tpm:24e3},Mixtral:{rpm:1,tpm:5e5},Groq:{rpm:30,tpm:15e3},"chatgpt-4o-latest":{rpm:1e4,tpm:3e7},"gpt-4o-mini":{rpm:3e4,tpm:15e7},"o1-preview":{rpm:500,tpm:3e7},"o1-mini":{rpm:1e3,tpm:15e7},"claude-3-opus-20240229":{tpm:8e4},"gemini-1.5-flash-exp-0827":{rpm:15,tpm:1e6},"gemini-1.5-pro-exp-0827":{rpm:2,tpm:32e3},"gemini-1.5-flash-002":{rpm:15,tpm:1e6},"gemini-1.5-pro-002":{rpm:2,tpm:32e3},"glm-4-long":{rpm:5},"glm-4-flash":{rpm:200}};let OneMinute=6e4,ModelRequestHistory={},ModelRequestPending={},getRateLimitHistory=e=>{var t=ModelRequestHistory[e];return t||(t={start:[],finish:[]},ModelRequestHistory[e]=t),t};globalThis.requestRateLimitLock=p=>new Promise(async e=>{var t=Model2AI[p]||"",t=(ModelRateLimit[p]||{}).rpm||(ModelRateLimit[t]||{}).rpm||0;if(t<=0)return e();var a=Date.now(),i=getRateLimitHistory(p),n=0,o=0,l=(i.start=i.start.filter(e=>a-e<=OneMinute),i.start.length>=t&&(n=OneMinute-a+i.start[0]),i.finish=i.finish.filter(e=>a-e<=OneMinute),i.finish.length>=t&&(o=OneMinute-a+i.finish[0]),Math.max(n,o)),n=(logger.strong("RPM","RPM "+p+" : "+t+" ("+i.start.length+", "+i.finish.length+") "+l),ModelRequestPending[p]);if(n||(n=[],ModelRequestPending[p]=n),n.push(e),0!==l){for(logger.strong("RPM","RPM Waiting: "+p);0<l;)5e3<l?(l-=5e3,await wait(5e3)):(await wait(l),l=0);await requestRateLimitLock(p),logger.strong("RPM","RPM Continue: "+p)}e=n[0],n.shift(),e&&e()}),globalThis.updateRateLimitLock=(e,t,a,i)=>{var n=Date.now(),e=getRateLimitHistory(e);(t?e.start:e.finish).unshift(n),e.start=e.start.filter(e=>n-e<=OneMinute),e.finish=e.finish.filter(e=>n-e<=OneMinute)};