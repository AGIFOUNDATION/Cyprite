let clearHTML=(e,r=!0,t=!1)=>{var n,a=document.createElement("container");for(a.innerHTML=e,[...a.querySelectorAll(".cyprite, .extension_component")].forEach(e=>{e.parentNode.removeChild(e)}),r&&[...a.querySelectorAll("form, select, button, textarea, input, object, script, style, nostyle, noscript, link, video, audio")].forEach(e=>{e.parentNode.removeChild(e)}),[...a.querySelectorAll("*")].forEach(r=>{[...r.attributes].forEach(e=>{if(e=e.name,t){if("href"===e)return;if("src"===e)return}r.removeAttribute(e)})}),t&&([...a.querySelectorAll("ul > li")].forEach(e=>{e.setAttribute("mark","-")}),[...a.querySelectorAll("ol > li")].forEach((e,r)=>{e.setAttribute("mark",r+1+".")})),e=(e=(e=(e=(e=a.innerHTML).replace(/<!\-\-[\w\W]*?\-\->/gi,"")).split(/\s*\n\s*/)).map(e=>e.trim()).filter(e=>!!e)).join("");e!==n;)e=(n=e).replace(/([\w\d\-])>\s+<(\/?[\w\d\-])/gi,(e,r,t)=>r+"><"+t);return e.trim()},getPageContent=(e,n=!1)=>{if(r=isString(e)?e:e.innerHTML||""){if(r=r.replace(/<img(\s+[\w\W]*?)?\/?>/gi,(e,r)=>{var t=(t=(r||"").match(/src=('|")([\w\W]*?)\1/))?t[2].trim():"",r=(r||"").match(/alt=('|")([\w\W]*?)\1/);return 0===(r=r?r[2].trim():"").indexOf("{")?n?"> "+r+"\n\n![]("+t+")":"> "+r:n?" !["+r+"]("+t+") ":" "+(r||"(image)")+" "}),r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=(r=clearHTML(r,!0,!0)).replace(/<(h\d)(\s+[\w\W]*?)?>([\w\W]*?)<\/\1>/gi,(e,r,t,n)=>1==(r=+r.match(/h(\d)/i)[1])?"\n\n##\t"+n+"\n\n":2==r?"\n\n###\t"+n+"\n\n":3==r?"\n\n####\t"+n+"\n\n":4==r?"\n\n#####\t"+n+"\n\n":5==r?"\n\n######\t"+n+"\n\n":n)).replace(/<\/?(article|header|section|aside|footer|div|p|center|ul|ol|tr)(\s+[\w\W]*?)?>/gi,"<br><br>")).replace(/<\/?(option|span|font)(\s+[\w\W]*?)?>/gi,"")).replace(/<\/(td|th)><\1(\s+[\w\W]*?)?>/gi," | ")).replace(/<(td|th)(\s+[\w\W]*?)?>/gi,"| ")).replace(/<\/(td|th)>/gi," |")).replace(/<hr(\s+[\w\W]*?)?>/gi,"<br>----<br>")).replace(/<li mark="([\w\W]+?)">/gi,(e,r)=>r+"\t")).replace(/<li(\s+[\w\W]*?)?>/gi,"-\t")).replace(/<\/li>/gi,"\n")).replace(/<\/?(b|strong)(\s+[\w\W]*?)?>/gi,"**")).replace(/<\/?(i|em)(\s+[\w\W]*?)?>/gi,"*"),n){let e="";for(;r!==e;)r=(e=r).replace(/<a(\s+[\w\W]*?)?>([\w\W]*?)<\/a>/gi,(e,r,t)=>{r=(r||"").match(/href=('|")([\w\W]*?)\1/);return r?"["+t+"]("+r[2]+")":t})}else r=r.replace(/<\/?a(\s+[\w\W]*?)?>/gi,"");var r=(r=(r=(r=(r=r.replace(/\s*<br>\s*/gi,"\n")).replace(/<\/?([\w\-\_]+)(\s+[\w\W]*?)?>/gi,"")).replace(/\r/g,"")).replace(/\n\n+/g,"\n\n")).trim();return r=(new DOMParser).parseFromString(r,"text/html").body.textContent}},parseMarkdownWithOutwardHyperlinks=(e,r,t)=>{r=marked.parse(r,{breaks:!0})||t||"";return e.innerHTML=r,[...e.querySelectorAll("a")].forEach(e=>{e.target="_blank"}),r};